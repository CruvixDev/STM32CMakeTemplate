![GitHub release](https://img.shields.io/github/v/release/CruvixDev/STM32CMakeTemplate)
![Build](https://github.com/cruvixdev/STM32CMakeTemplate/actions/workflows/STM32_CI-CD.yml/badge.svg)
![License](https://img.shields.io/badge/license-MIT-green)

![image](https://github.com/user-attachments/assets/359f3191-b27c-4982-b950-f91c0b88e8dc)

# STM32H7 template CMake project

This project gives a CMake template for STM32H7 development, based on CMSIS and Cube HAL / LL, integrated as Git submodules.

## Features

1. A app_version.hpp.in template file to retrieve the project version (Major, Minor and Patch), the Git hash of the commit and the compilate date. All these information are embedded in the final firmware in .elf format.
2. CMSIS and Cube HAL / LL are integrated as Git submodules, so that it is possible to compile the project with a specific version of theses drivers.
3. A tests folder based on Ceedling unit tests framework, Ruby is needed on the host to run tests.
4. A CMakePresets.json file, generated by ST CMake extension, is used to separate build folder into different variant (Debug, Release, etc.).

## How to use the CMake template project

1. Clone the repository on your host machine.
2. On the CMakeLists.txt file, select your STM32H7 microcontroller model.

```CMake
# User must set the STM32 model here
set(STM32_MODEL "STM32H723xx")
message("STM32 Model: " ${STM32_MODEL})
```

3. Configure CMake project
4. To modify CPU parameters, source files to be compiled, headers to include, add symbols, add libraries, add options, etc. Go to cmake/project_configuration.cmake file

## TODO

There is still a lot of work to be done on this project, to encompass all STM32xx/H7 models.

1. Linker script file is for STM32H723 model only, it must match the STM32 model selected.
2. The CMake template is only for STM32H7 family, add support for others families (F1, F4, F7, G0, etc.).
3. Create a super simple LED blinking example.
4. Add test example showing mocking of Cube HAL / LL library.
5. Create a documentation file explainging all the details to create this template from scratch.
6. Github Actions workflow now build and test, add deploy and lint phase
